name: CI

on:
  push:
    branches: [ main ]  # Trigger on push to 'main' branch
  pull_request:
    branches: [ main ]  # Trigger on PRs targeting 'main' branch

jobs:
  build:
    runs-on: ubuntu-latest  # Runs the pipeline on the latest Ubuntu VM

    steps:
      - name: Checkout code
        uses: actions/checkout@v3  # Checks out your repository

      - name: Set up Java 11
        uses: actions/setup-java@v3  # Sets up Java 11
        with:
          java-version: '11'

      - name: Build with Maven
        run: mvn clean package --batch-mode  # Executes Maven clean and package commands

      - name: Run unit tests
        run: mvn test  # Runs Maven tests

      - name: Upload WAR artifact
        uses: actions/upload-artifact@v3  # Uploads the built artifact (WAR file)
        with:
          name: webapp-package
          path: target/*.war  # Path to the WAR file generated by Maven

